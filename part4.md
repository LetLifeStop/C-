第四章 函数与程序结构

* 最简单的函数如下

  ```c++
  func() {}
  ```

  该函数不执行任何操作也不返回任何值，这种不执行任何操作的函数有时候会很有用，它可以在程序开发期间用以保留位置(留待以后填充代码)

* 如果一个函数从一个地方返回的时候有返回值，而从另一个地方返回的时候没有返回值，这个函数并不非法，但是可能是一种出问题的征兆

* 外部变量或者函数的作用域是从声明它的地方开始，到其所在的（待编译的）文件的末尾结束

* 如果要在外部变量的定义之前使用该变量，或者外部变量的定义和变量的使用不在同一个源文件中，则必须再相应的变量声明中强制性的使用关键字extern

* 变量的声明用于说明变量的属性，而变量的定义除此之外还将引起存储器的分配

  ```c++
  int sp;
  double val[MAXVAL];
  ```

  这两条语句将定义外部变量sp与val，并且为之分配存储单元

  ```c++
  extern int sp;
  extern double val[];
  ```

  这两条语句为源文件的其余部分声明了两个外部变量

* 定义外部变量的源文件也可以包含对该外部变量的extern声明。外部变量的定义中必须指定数组的长大夫，但是extern声明不一定要指定数组的长度。外部变量的初始化只能出现在其定义中

*  静态变量，用static声明限定外部变量和函数，可以将其后 **声明的对象的作用域限定为被编译源文件的剩余部分**，用static修饰的变量不会和同一程序中的其他文件中相同的名字相冲突。如果static修饰函数的话，该函数名除了对函数声明所在的文件可见的话，其他文件都无法访问。

* static修饰内部变量，不管函数是否被调用，它一直存在

* 寄存器变量，它所声明的变量在程序中使用频率较高，其思想是将register变量放在机器的寄存器上，这样可以使得程序更小，执行速度更快。但是实际使用的时候，底层硬件环境质有很小的变量可以保存在寄存器中，并且只允许某些类型的变量。但是过量的寄存器并没有什么坏处，这是因为编译器可以忽略过量的或者不支持的寄存器变量声明。

* 另外，不论寄存器变量实际上是不是存放在寄存器上的，他的地址都是不能访问的

* 递归并不节省存储器的开销，因为递归调用过程中必须在某个地方维护一个存储处理值的栈，递归的执行速度并不快，但是递归代码比较紧凑

* 宏替换，通常情况下，#define指令占一行，替换的文本时#define指令行末尾的所有剩余部分内容，但是也可以把一个较长的宏定义分成若干行，这是需要在待续的行末尾加上一个 反斜杠 \。 #define作用域从定义点开始，到被编译的源文件的末尾处结束。

* define在某些情况下时有缺陷的

  ```c++
  # define square(x) x * x
  cout << square(5 + 1)
  // 输出的却是11
  ```

* 可以通过#undef取消名字的宏定义

* 形式参数不能用带引号的字符串替换，但是如果在替换文本中参数名以￥为前缀，则结果将被扩展为由实际参数替换该参数的带引号的字符串

  ```c++
  # define dprint(expr) printf(#expr " = %g\n", expr)
  ```

  使用语句 

  ```c++
  dprint(x/y);
  ```

  调用该宏时，该宏定义将被扩展为

  ```c++
  printf("x/y" " = %g\n", x/y);
  printf("x/y = %g\n", x/y);
  ```

  在实际的参数中，每一个双引号"将被替换为 \\"，反斜杠被替换为 \\\ ,因此替换后的字符串时合法的字符串常量。

* 预处理器运算符##为宏扩展提供了一种连接实际参数的手段，如果替换文本中的参数和##相邻，则该参数呗实际参数替换，##与前后的空白符将被删除。并且对替换后的结果重新扫描

  ```c++
  # define paste(front, back) front ## back
  ```

  当调用宏定义paste(name, 1)时，将创建记号 name1

* 条件包含，可以通过条件语句对预处理本身进行控制，可以在编译过程中根据计算所得到的条件值选择性的包含不同代码提供了一种手段。#if语句根据对其中的常量整型表达式（不包含sizeof,类型转换符或者enum常量），如果表达式的值不等于0，则包含后面的各行，知道遇到#endif, #elif或者#else语句为止

  ```c++
  #if !defined(HDR)
  #define HDR
  ...
  #endif
  ```

  c语言专门定义了两个预处理语句#ifdef和#ifndef，用来测试某个名字是否已经定义

